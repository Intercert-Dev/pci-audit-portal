<div class="main-layout" [class.sidebar-collapsed]="!isSidebarOpen">
  <header class="topbar">
    <div class="topbar-left-items">
      <button class="menu-btn" (click)="toggleSidebar()">
        <img src="/assets/icons/dehaze.png" alt="icons">
      </button>
      <div class="logo">
        <img src="/assets/main-logo.svg" alt="Intercert Logo" />
      </div>
    </div>
    <div class="header-right">
      <p>Dashboard</p>
      <div class="header-right-items">
        <div class="search-box">
          <img src="/assets/icons/magnifying-glass 1.png" alt="Search icon">
          <input type="text" placeholder="Search for something">
        </div>
        <div class="notification-bell">
          <img id="notification-icon" src="/assets/icons/002-notification-1.png" alt="Notifications">
        </div>
        <div class="user-dropdown" (click)="toggleDropdown()" (mouseleave)="closeDropdown()">
          <img id="user-icon" src="https://img.freepik.com/free-vector/blue-circle-with-white-user_78370-4707.jpg"
            alt="User" class="user-avatar" />
          <div class="dropdown-menu" *ngIf="dropdownOpen">
            <div class="dropdown-item" (click)="goToProfile($event)">Profile</div>
            <div class="dropdown-item" (click)="logout($event)">Logout</div>
          </div>
        </div>
      </div>
    </div>
  </header>
  <div class="layout-body">
    <div class="sidebar-wrapper" [class.collapsed]="!isSidebarOpen && windowWidth > 1024">
      <aside class="sidebar" [class.open]="isSidebarOpen && windowWidth <= 1024">
        <nav class="sidebar-nav">
          <ul>
            <!-- MAIN MENU ITEMS - Close submenu when clicked -->
            <li routerLink="/dashboard" routerLinkActive="active" (click)="onMainMenuItemClick()">
              <div style="padding-left: 4px; gap: 1.2rem;" class="nav-item">
                <img src="/assets/icons/home.png" alt="icon" class="nav-icon">
                <span class="nav-text">Dashboard</span>
              </div>
            </li>

            <!-- CLIENTS SUBMENU -->
            <li class="has-submenu" [class.expanded]="isClientsExpanded">
              <div class="submenu-header" (click)="toggleClientsMenu($event)">
                <div class="nav-item">
                  <img src="/assets/icons/person_add.png" alt="icon" class="nav-icon">
                  <span class="nav-text">Clients</span>
                  <img class="arrow-icon" [class.rotate]="isClientsExpanded" src="/assets/icons8-dropdown-50.png"
                    alt="arrow">
                </div>
              </div>
              <!-- SUBMENU ITEMS - DON'T close submenu when clicked -->
              <ul class="submenu" *ngIf="isClientsExpanded">
                <li routerLink="/add-client" routerLinkActive="active" (click)="onSubmenuItemClick()">
                  <span>Add Client</span>
                </li>
                <li routerLink="/add-audit" routerLinkActive="active" (click)="onSubmenuItemClick()">
                  <span>Add Audit</span>
                </li>
                <li routerLink="/add-asv-audit" routerLinkActive="active" (click)="onSubmenuItemClick()">
                  <span>ASV Audit</span>
                </li>
                <li routerLink="/report-verification" routerLinkActive="active" (click)="onSubmenuItemClick()">
                  <span>Report Verification</span>
                </li>
              </ul>
            </li>
            <!-- Lists SUBMENU -->
            <li class="has-submenu" [class.expanded]="isListExpanded">
              <div class="submenu-header" (click)="toggleListsMenu($event)">
                <div class="nav-item">
                  <img src="/assets/icons/calendar_view_week.png" alt="icon" class="nav-icon">
                  <span class="nav-text">Lists</span>
                  <img class="arrow-icon" [class.rotate]="isListExpanded" src="/assets/icons8-dropdown-50.png"
                    alt="arrow">
                </div>
              </div>
              <!-- SUBMENU ITEMS - DON'T close submenu when clicked -->
              <ul class="submenu" *ngIf="isListExpanded">
                <li routerLink="/client-list" routerLinkActive="active" (click)="onSubmenuItemClick()">
                  <span>Clients</span>
                </li>
                <li routerLink="/audit-list" routerLinkActive="active" (click)="onSubmenuItemClick()">
                  <span>Audits</span>
                </li>
                <li routerLink="/asv-audit-client-list" routerLinkActive="active" (click)="onSubmenuItemClick()">
                  <span>ASV Audits</span>
                </li>
                <li routerLink="/pci-reports-list" routerLinkActive="active" (click)="onSubmenuItemClick()">
                  <span>PCI Reports</span>
                </li>
              </ul>
            </li>



            <!-- MAIN MENU ITEMS - Close submenu when clicked -->
            <!-- <li routerLink="/client-list" routerLinkActive="active" (click)="onMainMenuItemClick()">
              <div class="nav-item">
                <img src="/assets/icons/calendar_view_week.png" alt="icon" class="nav-icon">
                <span class="nav-text">Client List</span>
              </div>
            </li> -->
            <li routerLink="/asv-dashboard" routerLinkActive="active" (click)="onMainMenuItemClick()">
              <div class="nav-item">
                <img src="/assets/icons/breaking_news_alt_1.png" alt="icon" class="nav-icon">
                <span class="nav-text">ASV</span>
              </div>
            </li>

            <li routerLink="/asv-client-list" routerLinkActive="active" (click)="onMainMenuItemClick()">
              <div class="nav-item">
                <img src="/assets/icons/calendar_view_week.png" alt="icon" class="nav-icon">
                <span class="nav-text">ASV Client List</span>
              </div>
            </li>

            <li routerLink="/certificate-gen" routerLinkActive="active" (click)="onMainMenuItemClick()">
              <div class="nav-item">
                <img src="/assets/icons/card_membership.png" alt="icon" class="nav-icon">
                <span class="nav-text">Certificate Gen.</span>
              </div>
            </li>

            <li *ngIf="userRole === 'SUPER_ADMIN'" routerLink="/create-user" routerLinkActive="active"
              (click)="onMainMenuItemClick()">
              <div class="nav-item">
                <img src="/assets/icons/person_add.png" alt="icon" class="nav-icon">
                <span class="nav-text">Create User</span>
              </div>
            </li>


            <li routerLink="/user-settings" routerLinkActive="active" (click)="onMainMenuItemClick()">
              <div class="nav-item">
                <img src="/assets/icons/settings solid 1.png" alt="icon" class="nav-icon">
                <span class="nav-text">Settings</span>
              </div>
            </li>
          </ul>
        </nav>
      </aside>
    </div>

    <!-- MOBILE OVERLAY -->
    <div class="sidebar-overlay" *ngIf="isSidebarOpen && windowWidth <= 1024" (click)="toggleSidebar()"></div>

    <main class="main-content">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>