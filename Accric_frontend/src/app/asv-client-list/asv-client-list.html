<div class="client-list-container">
    <div class="client-list-box">
        <div class="header-row">
            <p>ASV Client List</p>
            <div class="header-right">
                <div class="search-box">
                    <img src="/assets/icons/magnifying-glass 2.png" alt="Search Icon">
                    <input type="text" placeholder="Search Certificates" [(ngModel)]="serarch_text"
                        (input)="filter_list()">
                </div>
                <button class="export-btn" (click)="exportToExcel()"><span>Export to Excel</span></button>
            </div>
        </div>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Company</th>
                        <th>Q1</th>
                        <th>Q2</th>
                        <th>Q3</th>
                        <th>Q4</th>
                        <th>Action</th>
                    </tr>
                </thead>

                <tbody>
                    <!-- Example Row -->
                    <tr *ngFor="let row of filtered_list">
                        <td>{{ row.company }}</td>
                        <td>{{ row.Q1 }}</td>
                        <td>{{ row.Q2 }}</td>
                        <td>{{ row.Q3 }}</td>
                        <td>{{ row.Q4 }}</td>
                        <td>
                            <div class="action-box">
                                <img src="/assets/icons/edit.png" alt="Edit" (click)="editRow(row)">
                                <img src="/assets/icons/delete.png" alt="Delete" (click)="deleteRow(row)">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>


<div class="edit-popup" *ngIf="editingRow">
    <h2>Edit Client</h2>

    <!-- Row 1 -->
    <div class="form-row">
        <div class="form-group">
            <label>Company</label>
            <input type="text" [(ngModel)]="editingRow.company" readonly>

        </div>


    </div>

    <!-- Row 2 -->
    <div class="form-row">
        <!-- Q1 -->
        <div class="form-group">
            <label>Q1 Report</label>

            <div class="report-file-box">
                <input type="text" [value]="editingRow.Q1File ? editingRow.Q1File.name : 'No file selected'" disabled />

                <div class="report-buttons">
                    <button type="button" class="btn-upload" (click)="triggerInput('Q1')">
                        <span>Upload</span>
                    </button>

                    <button type="button" class="btn-preview" (click)="onPreview('Q1')" [disabled]="!editingRow.Q1File">
                        <span>Preview</span>
                    </button>

                    <button type="button" class="btn-download" (click)="onDownload('Q1')"
                        [disabled]="!editingRow.Q1File">
                        <span>Download</span>
                    </button>
                </div>
            </div>

            <input type="file" #Q1Input hidden (change)="onFileSelect($event, 'Q1')">
        </div>

        <!-- Q2 -->
        <div class="form-group">
            <label>Q2 Report</label>

            <div class="report-file-box">
                <input type="text" [value]="editingRow.Q2File ? editingRow.Q2File.name : 'No file selected'" disabled />

                <div class="report-buttons">
                    <button type="button" class="btn-upload" (click)="triggerInput('Q2')">
                        <span>Upload</span>
                    </button>

                    <button type="button" class="btn-preview" (click)="onPreview('Q2')" [disabled]="!editingRow.Q2File">
                        <span>Preview</span>
                    </button>

                    <button type="button" class="btn-download" (click)="onDownload('Q2')"
                        [disabled]="!editingRow.Q2File">
                        <span>Download</span>
                    </button>
                </div>
            </div>

            <input type="file" #Q2Input hidden (change)="onFileSelect($event, 'Q2')">
        </div>


    </div>


    <div class="form-row">


        <!-- Q3 -->
        <div class="form-group">
            <label>Q3 Report</label>

            <div class="report-file-box">
                <input type="text" [value]="editingRow.Q3File ? editingRow.Q3File.name : 'No file selected'" disabled />

                <div class="report-buttons">
                    <button type="button" class="btn-upload" (click)="triggerInput('Q3')">
                        <span>Upload</span>
                    </button>

                    <button type="button" class="btn-preview" (click)="onPreview('Q3')" [disabled]="!editingRow.Q3File">
                        <span>Preview</span>
                    </button>

                    <button type="button" class="btn-download" (click)="onDownload('Q3')"
                        [disabled]="!editingRow.Q3File">
                        <span>Download</span>
                    </button>
                </div>
            </div>

            <input type="file" #Q3Input hidden (change)="onFileSelect($event, 'Q3')">
        </div>

        <!-- Q4 -->
        <div class="form-group">
            <label>Q4 Report</label>

            <div class="report-file-box">
                <input type="text" [value]="editingRow.Q4File ? editingRow.Q4File.name : 'No file selected'" disabled />

                <div class="report-buttons">
                    <button type="button" class="btn-upload" (click)="triggerInput('Q4')">
                        <span>Upload</span>
                    </button>

                    <button type="button" class="btn-preview" (click)="onPreview('Q4')" [disabled]="!editingRow.Q4File">
                        <span>Preview</span>
                    </button>

                    <button type="button" class="btn-download" (click)="onDownload('Q4')"
                        [disabled]="!editingRow.Q4File">
                        <span>Download</span>
                    </button>
                </div>
            </div>

            <input type="file" #Q4Input hidden (change)="onFileSelect($event, 'Q4')">
        </div>
    </div>


    <div class="buttons">
        <button class="save-btn" (click)="saveEdit()">Save</button>
        <button class="cancel-btn" (click)="cancelEdit()">Cancel</button>
    </div>
</div>